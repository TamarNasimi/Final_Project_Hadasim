כאשר הנתונים מגעים בזרימה לא נצטרך לקרוא קובץ שלם בבת אחת, נצטרך לשב באופן דינאמי את הממוצעים תוך כדי שממשיכים לקבל עוד נתונים.
אפשר להשתמש במילון, כל מפתח מייצג שעה עגולה, והערך יהיה רשימה של הערכים שהתקבלו בשעה של המפתח.
בכל פעם שמגיע נתונים חדשים (חותמת זמן וערך) מוצאים את השעה המתאימה במילון לאחר שמעגלים את השעה ומוסיפים את הערך לרשימה של אותה שעה במילון, ומעדכנים ממוצע.
כמובן שלאחר בדיקות שהערכים תקינים, שאין משתנה ריק שישבש את החישוב של הממוצע.
בכל פרק זמן מוגדר נכתוב את הממוצעים שהצטברו לקובץ.